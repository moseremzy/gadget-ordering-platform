"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[927],{8158:function(e,i,t){t.r(i),t.d(i,{default:function(){return Q}});t(4114),t(8992),t(2577);var a=t(6768),r=t(4232),o=t(144),l=t(5130),n=t(4549),s=t(3306),c=t(3604),d=t(5149),u=t(6282),m=t(9102),p=t(8238),_=t(1387),f=t(868),g=t(3216),v=(t(2090),t(4542));const k={class:"add-item-form-container"},b={enctype:"multipart/form-data",method:"post",action:"/update_photo"},y={class:"profile"},L=["src"],R={for:"imageFile"},h=["src"],C={for:"videoFile"},q={class:"add-item-form grid-form"},A={class:"form-group grid-full"},I={class:"err"},E={class:"form-group"},F={class:"err"},w={class:"form-group"},x=["value"],V={class:"err"},S={class:"form-group"},U={class:"err"},P={class:"form-group"},K={class:"err"},X={class:"form-group"},z={class:"err"},$={class:"form-group grid-full"},B={class:"err"},T={class:"form-group grid-full"};var W={__name:"Edit-Item",setup(e){const i=(0,p.j)(),t=(0,n.g)(),W=(0,_.lq)(),D=(0,_.rd)(),J=(0,g.K)(),Q=(0,f.d)();let j=(0,o.KR)(null),O=((0,o.KR)(""),(0,o.KR)(null)),M=(0,o.KR)(null);const N=W.params.item_id;let Z=(0,o.Kh)([]),G=(0,o.Kh)({name_err:"",price_err:"",description_err:"",category_err:"",condition_err:"",quantity_err:"",status_err:"",image_err:""});t.isAuthenticated||D.push({path:"/login"}),(0,a.wB)((()=>t.isAuthenticated),(e=>{e||(i.backend_message="session expired",i.display_success_alert_box(!0),setTimeout((()=>{D.push({path:"/login"})}),1e3))}));const H=(0,a.EW)((()=>Q.categories));function Y(e){Z=J.products.find((i=>i.product_id==e)),Z||D.push({name:"dashboard"})}function ee(){let e=/^[A-Za-z0-9\s]+$/;if(""===Z.name)G.name_err="Please fill the field";else{if(e.test(Z.name))return G.name_err="",!0;G.name_err="Item name can only contain letters and spaces"}}function ie(){if(""!==Z.price)return G.price_err="",!0;G.price_err="Please fill field"}function te(){if(""!==Z.category_id&&"Select Category"!=Z.category_id)return G.category_err="",!0;G.category_err="Please fill field"}function ae(){if(""!==Z.product_condition&&"Select Condition"!=Z.product_condition)return G.condition_err="",!0;G.condition_err="Please fill field"}function re(){if(""!==Z.stock_quantity)return G.quantity_err="",!0;G.quantity_err="Please fill field"}function oe(){if(""!==Z.status)return G.status_err="",!0;G.status_err="Please fill field"}function le(){if(Z.description.length>=400)Z.description=Z.description.slice(0,400),j.value.attributes[2].nodeValue="color: red;";else{if(""!=Z.description)return j.value.attributes[2].nodeValue="color: gray;",G.description_err="",!0;G.description_err="Please fill field"}}async function ne(e){const t="image"===e?O.value:M.value,a=t.files[0];if(!a)return i.backend_message=`Please upload a ${e}`,void i.display_error_alert_box();const r=["image/png","image/jpeg","image/jpg","image/webp"],o=["video/mp4","video/quicktime","video/webm"];if("image"===e&&!r.includes(a.type))return i.backend_message="Invalid image file",void i.display_error_alert_box();if("video"===e&&!o.includes(a.type))return i.backend_message="Invalid video file",void i.display_error_alert_box();if("image"===e&&a.size>5242880||"video"===e&&a.size>31457280)return i.backend_message="image"===e?"Image can't be larger than 5MB":"Video can't be larger than 30MB",void i.display_error_alert_box();const l=new FormData;l.append("item_id",Z.product_id),l.append("current_media_url","image"===e?Z.main_image:Z.main_video),l.append(e,a,a.name),i.toggle_loading_overlay(!0);try{const t="image"===e?await v.A.update_photo(l):await v.A.update_video(l);"image"===e?Z.main_image=t.data.main_image:Z.main_video=t.data.main_video,i.backend_message=`${e.charAt(0).toUpperCase()+e.slice(1)} updated successfully`,i.display_success_alert_box()}catch(n){console.log(n)}i.toggle_loading_overlay(!1)}async function se(e){if(Z.main_video){i.toggle_loading_overlay(!0);try{await v.A.delete_video({data:{current_media_url:Z.main_video,item_id:e}}),Z.main_video=null,i.backend_message="Video deleted successfully",i.display_success_alert_box()}catch(t){console.log(t)}i.toggle_loading_overlay(!1)}}async function ce(e){if(ee()&&ie()&&te()&&le()&&ae()&&re()&&oe()){i.toggle_loading_overlay(!0);try{await v.A.update_item({...Z});await J.fetch_products(),i.backend_message="Item uploaded successfully",i.display_success_alert_box()}catch(t){i.backend_message="Error occurred, please try again",i.display_error_alert_box()}i.toggle_loading_overlay(!1)}}return Y(N),(0,a.$u)((()=>{ee(),ie(),le(),te(),ae(),re(),oe()})),(e,t)=>{const n=(0,a.g2)("SUCCESSALERTBOX"),p=(0,a.g2)("ERRORALERTBOX"),_=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",{class:"container",style:(0,r.Tr)((0,o.R1)(i).container_css)},[(0,a.bF)(c.A),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)((0,o.R1)(i).backend_message),1)])),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)((0,o.R1)(i).backend_message),1)])),_:1}),(0,a.bF)(d.A),(0,a.Lk)("div",{class:"sub_container",style:(0,r.Tr)((0,o.R1)(i).sub_container_css)},[(0,a.bF)(s.A,{page_name:"edit-item"}),(0,a.Lk)("h1",null,"Edit "+(0,r.v_)((0,o.R1)(Z).name),1),(0,a.Lk)("div",k,[(0,a.bF)(u.A,{class:"left-badge",product:(0,o.R1)(Z)},null,8,["product"]),(0,a.bF)(m.A,{class:"right-badge",product:(0,o.R1)(Z)},null,8,["product"]),(0,a.Lk)("form",b,[(0,a.Lk)("div",y,[(0,a.Lk)("div",null,[(0,a.Lk)("img",{src:(0,o.R1)(Z).main_image,class:"media"},null,8,L),(0,a.Lk)("label",R,[(0,a.bF)(_,{style:{"font-size":"14px"},icon:"fa-solid fa-camera"}),t[10]||(t[10]=(0,a.eW)(" Change Photo ")),(0,a.Lk)("input",{type:"file",onChange:t[0]||(t[0]=e=>ne("image")),id:"imageFile",ref_key:"imageInput",ref:O,accept:"image/*"},null,544)])]),(0,a.Lk)("div",null,[(0,o.R1)(Z).main_video?((0,a.uX)(),(0,a.CE)("video",{key:0,src:(0,o.R1)(Z).main_video,controls:"",class:"media"},null,8,h)):(0,a.Q3)("",!0),(0,a.Lk)("label",C,[(0,a.bF)(_,{style:{"font-size":"14px"},icon:"fa-solid fa-video"}),(0,a.eW)(" "+(0,r.v_)((0,o.R1)(Z).main_video?"Change Video":"Add Video")+" ",1),(0,a.Lk)("input",{type:"file",onChange:t[1]||(t[1]=e=>ne("video")),id:"videoFile",ref_key:"videoInput",ref:M,accept:"video/*"},null,544)]),(0,o.R1)(Z).main_video?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[2]||(t[2]=(0,l.D$)((e=>se((0,o.R1)(Z).product_id)),["prevent"])),class:"delete-btn"},[(0,a.bF)(_,{style:{"font-size":"14px"},icon:"fa-solid fa-trash"})])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("form",q,[(0,a.Lk)("div",A,[t[11]||(t[11]=(0,a.Lk)("label",{for:"item-name",class:"form-label"},"Item Name",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"item-name","onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.R1)(Z).name=e),class:"form-input",placeholder:"Enter item name",required:""},null,512),[[l.Jo,(0,o.R1)(Z).name]]),(0,a.Lk)("p",I,(0,r.v_)((0,o.R1)(G).name_err),1)]),(0,a.Lk)("div",E,[t[12]||(t[12]=(0,a.Lk)("label",{for:"item-price",class:"form-label"},"Item Price",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>(0,o.R1)(Z).price=e),id:"item-price",class:"form-input",placeholder:"Enter item price",required:""},null,512),[[l.Jo,(0,o.R1)(Z).price]]),(0,a.Lk)("p",F,(0,r.v_)((0,o.R1)(G).price_err),1)]),(0,a.Lk)("div",w,[t[14]||(t[14]=(0,a.Lk)("label",{for:"item-category",class:"form-label"},"Item Category",-1)),(0,a.bo)((0,a.Lk)("select",{id:"item-category","onUpdate:modelValue":t[5]||(t[5]=e=>(0,o.R1)(Z).category_id=e),class:"form-input",required:""},[t[13]||(t[13]=(0,a.Lk)("option",{value:""},"Select Category",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(H.value,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.category_id,value:e.category_id},(0,r.v_)(e.name),9,x)))),128))],512),[[l.u1,(0,o.R1)(Z).category_id]]),(0,a.Lk)("p",V,(0,r.v_)((0,o.R1)(G).category_err),1)]),(0,a.Lk)("div",S,[t[16]||(t[16]=(0,a.Lk)("label",{for:"item-condition",class:"form-label"},"Item Condition",-1)),(0,a.bo)((0,a.Lk)("select",{id:"item-condition","onUpdate:modelValue":t[6]||(t[6]=e=>(0,o.R1)(Z).product_condition=e),class:"form-input",required:""},t[15]||(t[15]=[(0,a.Lk)("option",{value:""},"Select Condition",-1),(0,a.Lk)("option",{value:"new"},"New",-1),(0,a.Lk)("option",{value:"uk_used"},"Uk Used",-1),(0,a.Lk)("option",{value:"refurbished"},"Refurbished",-1)]),512),[[l.u1,(0,o.R1)(Z).product_condition]]),(0,a.Lk)("p",U,(0,r.v_)((0,o.R1)(G).condition_err),1)]),(0,a.Lk)("div",P,[t[17]||(t[17]=(0,a.Lk)("label",{for:"item-quantity",class:"form-label"},"Item Quantity",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",id:"item-quantity",min:"1",placeholder:"Stock Quantity","onUpdate:modelValue":t[7]||(t[7]=e=>(0,o.R1)(Z).stock_quantity=e),class:"form-input",required:""},null,512),[[l.Jo,(0,o.R1)(Z).stock_quantity]]),(0,a.Lk)("p",K,(0,r.v_)((0,o.R1)(G).quantity_err),1)]),(0,a.Lk)("div",X,[t[19]||(t[19]=(0,a.Lk)("label",{for:"item-status",class:"form-label"},"Item Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"item-status","onUpdate:modelValue":t[8]||(t[8]=e=>(0,o.R1)(Z).status=e),class:"form-input",required:""},t[18]||(t[18]=[(0,a.Lk)("option",{value:""},"Select Status",-1),(0,a.Lk)("option",{value:"active"},"Active",-1),(0,a.Lk)("option",{value:"inactive"},"Inactive",-1)]),512),[[l.u1,(0,o.R1)(Z).status]]),(0,a.Lk)("p",z,(0,r.v_)((0,o.R1)(G).status_err),1)]),(0,a.Lk)("div",$,[t[20]||(t[20]=(0,a.Lk)("label",{for:"item-description",class:"form-label"},"Item Description",-1)),(0,a.bo)((0,a.Lk)("textarea",{id:"item-description","onUpdate:modelValue":t[9]||(t[9]=e=>(0,o.R1)(Z).description=e),class:"form-input",placeholder:"Enter item description",rows:"4",required:""},null,512),[[l.Jo,(0,o.R1)(Z).description]]),(0,a.Lk)("p",B,(0,r.v_)((0,o.R1)(G).description_err),1),(0,a.Lk)("p",{class:"err",style:{color:"gray"},ref_key:"description_counter",ref:j},(0,r.v_)((0,o.R1)(Z).description.length)+"/400 characters",513)]),(0,a.Lk)("div",T,[(0,a.Lk)("button",{type:"submit",onClick:(0,l.D$)(ce,["prevent"]),class:"submit-button"},"Submit")])])])],4)],4)}}},D=t(1241);const J=(0,D.A)(W,[["__scopeId","data-v-2ea7ada1"]]);var Q=J}}]);
//# sourceMappingURL=927.701e5a89.js.map