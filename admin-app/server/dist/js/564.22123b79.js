"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[564],{9218:function(e,i,t){t.r(i),t.d(i,{default:function(){return Q}});t(4114),t(8992),t(2577);var a=t(6768),r=t(4232),o=t(144),l=t(5130),n=t(4549),s=t(3306),c=t(3604),d=t(5149),u=t(6282),m=t(9102),p=t(8238),_=t(1387),f=t(868),g=t(3216),v=(t(2090),t(4542));const k={class:"add-item-form-container"},b={enctype:"multipart/form-data",method:"post",action:"/update_photo"},y={class:"profile"},L=["src"],R={for:"imageFile"},h=["src"],C={for:"videoFile"},q={class:"add-item-form grid-form"},I={class:"form-group grid-full"},A={class:"err"},F={class:"form-group"},w={for:"item-price",class:"form-label"},E={class:"err"},x={class:"form-group"},V=["value"],S={class:"err"},U={class:"form-group"},P={class:"err"},K={class:"form-group"},X={class:"err"},N={class:"form-group"},z={class:"err"},B={class:"form-group grid-full"},T={class:"err"},W={class:"form-group grid-full"};var $={__name:"Edit-Item",setup(e){const i=(0,p.j)(),t=(0,n.g)(),$=(0,_.lq)(),D=(0,_.rd)(),J=(0,g.K)(),Q=(0,f.d)();let j=(0,o.KR)(null),O=((0,o.KR)(""),(0,o.KR)(null)),G=(0,o.KR)(null);const M=$.params.item_id;let H=(0,o.Kh)([]),Y=(0,o.Kh)({name_err:"",price_err:"",description_err:"",category_err:"",condition_err:"",quantity_err:"",status_err:"",image_err:""});t.isAuthenticated||D.push({path:"/login"}),(0,a.wB)((()=>t.isAuthenticated),(e=>{e||(i.backend_message="session expired",i.display_success_alert_box(!0),setTimeout((()=>{D.push({path:"/login"})}),1e3))}));const Z=(0,a.EW)((()=>Q.categories));function ee(e){H=J.products.find((i=>i.product_id==e)),H||D.push({name:"dashboard"})}function ie(){if(""!==H.name)return Y.name_err="",!0;Y.name_err="Please fill the field"}function te(){if(""!==H.price)return Y.price_err="",!0;Y.price_err="Please fill field"}function ae(){if(""!==H.category_id&&"Select Category"!=H.category_id)return Y.category_err="",!0;Y.category_err="Please fill field"}function re(){if(""!==H.product_condition&&"Select Condition"!=H.product_condition)return Y.condition_err="",!0;Y.condition_err="Please fill field"}function oe(){if(""!==H.stock_quantity)return Y.quantity_err="",!0;Y.quantity_err="Please fill field"}function le(){if(""!==H.status)return Y.status_err="",!0;Y.status_err="Please fill field"}function ne(){if(H.description.length>=400)H.description=H.description.slice(0,400),j.value.attributes[2].nodeValue="color: red;";else{if(""!=H.description)return j.value.attributes[2].nodeValue="color: gray;",Y.description_err="",!0;Y.description_err="Please fill field"}}async function se(e){const t="image"===e?O.value:G.value,a=t.files[0];if(!a)return i.backend_message=`Please upload a ${e}`,void i.display_error_alert_box();const r=["image/png","image/jpeg","image/jpg","image/webp"],o=["video/mp4","video/quicktime","video/webm"];if("image"===e&&!r.includes(a.type))return i.backend_message="Invalid image file",void i.display_error_alert_box();if("video"===e&&!o.includes(a.type))return i.backend_message="Invalid video file",void i.display_error_alert_box();if("image"===e&&a.size>5242880||"video"===e&&a.size>31457280)return i.backend_message="image"===e?"Image can't be larger than 5MB":"Video can't be larger than 30MB",void i.display_error_alert_box();const l=new FormData;l.append("item_id",H.product_id),l.append("current_media_url","image"===e?H.main_image:H.main_video),l.append(e,a,a.name),i.toggle_loading_overlay(!0);try{const t="image"===e?await v.A.update_photo(l):await v.A.update_video(l);"image"===e?H.main_image=t.data.main_image:H.main_video=t.data.main_video,i.backend_message=`${e.charAt(0).toUpperCase()+e.slice(1)} updated successfully`,i.display_success_alert_box()}catch(n){console.log(n)}i.toggle_loading_overlay(!1)}async function ce(e){if(H.main_video){i.toggle_loading_overlay(!0);try{await v.A.delete_video({data:{current_media_url:H.main_video,item_id:e}}),H.main_video=null,i.backend_message="Video deleted successfully",i.display_success_alert_box()}catch(t){console.log(t)}i.toggle_loading_overlay(!1)}}async function de(e){if(ie()&&te()&&ae()&&ne()&&re()&&oe()&&le()){i.toggle_loading_overlay(!0);try{await v.A.update_item({...H});await J.fetch_products(),i.backend_message="Item uploaded successfully",i.display_success_alert_box()}catch(t){i.backend_message="Error occurred, please try again",i.display_error_alert_box()}i.toggle_loading_overlay(!1)}}return ee(M),(0,a.$u)((()=>{ie(),te(),ne(),ae(),re(),oe(),le()})),(e,t)=>{const n=(0,a.g2)("SUCCESSALERTBOX"),p=(0,a.g2)("ERRORALERTBOX"),_=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",{class:"container",style:(0,r.Tr)((0,o.R1)(i).container_css)},[(0,a.bF)(c.A),(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)((0,o.R1)(i).backend_message),1)])),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)((0,o.R1)(i).backend_message),1)])),_:1}),(0,a.bF)(d.A),(0,a.Lk)("div",{class:"sub_container",style:(0,r.Tr)((0,o.R1)(i).sub_container_css)},[(0,a.bF)(s.A,{page_name:"edit-item"}),(0,a.Lk)("h1",null,"Edit "+(0,r.v_)((0,o.R1)(H).name.slice(0,30))+"...",1),(0,a.Lk)("div",k,[(0,a.bF)(u.A,{class:"left-badge",product:(0,o.R1)(H)},null,8,["product"]),(0,a.bF)(m.A,{class:"right-badge",product:(0,o.R1)(H)},null,8,["product"]),(0,a.Lk)("form",b,[(0,a.Lk)("div",y,[(0,a.Lk)("div",null,[(0,a.Lk)("img",{src:(0,o.R1)(H).main_image,class:"media"},null,8,L),(0,a.Lk)("label",R,[(0,a.bF)(_,{style:{"font-size":"14px"},icon:"fa-solid fa-camera"}),t[10]||(t[10]=(0,a.eW)(" Change Photo ")),(0,a.Lk)("input",{type:"file",onChange:t[0]||(t[0]=e=>se("image")),id:"imageFile",ref_key:"imageInput",ref:O,accept:"image/*"},null,544)])]),(0,a.Lk)("div",null,[(0,o.R1)(H).main_video?((0,a.uX)(),(0,a.CE)("video",{key:0,src:(0,o.R1)(H).main_video,controls:"",class:"media"},null,8,h)):(0,a.Q3)("",!0),(0,a.Lk)("label",C,[(0,a.bF)(_,{style:{"font-size":"14px"},icon:"fa-solid fa-video"}),(0,a.eW)(" "+(0,r.v_)((0,o.R1)(H).main_video?"Change Video":"Add Video")+" ",1),(0,a.Lk)("input",{type:"file",onChange:t[1]||(t[1]=e=>se("video")),id:"videoFile",ref_key:"videoInput",ref:G,accept:"video/*"},null,544)]),(0,o.R1)(H).main_video?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[2]||(t[2]=(0,l.D$)((e=>ce((0,o.R1)(H).product_id)),["prevent"])),class:"delete-btn"},[(0,a.bF)(_,{style:{"font-size":"14px"},icon:"fa-solid fa-trash"})])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("form",q,[(0,a.Lk)("div",I,[t[11]||(t[11]=(0,a.Lk)("label",{for:"item-name",class:"form-label"},"Item Name",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"item-name","onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.R1)(H).name=e),class:"form-input",placeholder:"Enter item name",required:""},null,512),[[l.Jo,(0,o.R1)(H).name]]),(0,a.Lk)("p",A,(0,r.v_)((0,o.R1)(Y).name_err),1)]),(0,a.Lk)("div",F,[(0,a.Lk)("label",w,"Item Price ("+(0,r.v_)(new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format((0,o.R1)(H).price))+")",1),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>(0,o.R1)(H).price=e),id:"item-price",class:"form-input",placeholder:"Enter item price",required:""},null,512),[[l.Jo,(0,o.R1)(H).price]]),(0,a.Lk)("p",E,(0,r.v_)((0,o.R1)(Y).price_err),1)]),(0,a.Lk)("div",x,[t[13]||(t[13]=(0,a.Lk)("label",{for:"item-category",class:"form-label"},"Item Category",-1)),(0,a.bo)((0,a.Lk)("select",{id:"item-category","onUpdate:modelValue":t[5]||(t[5]=e=>(0,o.R1)(H).category_id=e),class:"form-input",required:""},[t[12]||(t[12]=(0,a.Lk)("option",{value:""},"Select Category",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.value,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.category_id,value:e.category_id},(0,r.v_)(e.name),9,V)))),128))],512),[[l.u1,(0,o.R1)(H).category_id]]),(0,a.Lk)("p",S,(0,r.v_)((0,o.R1)(Y).category_err),1)]),(0,a.Lk)("div",U,[t[15]||(t[15]=(0,a.Lk)("label",{for:"item-condition",class:"form-label"},"Item Condition",-1)),(0,a.bo)((0,a.Lk)("select",{id:"item-condition","onUpdate:modelValue":t[6]||(t[6]=e=>(0,o.R1)(H).product_condition=e),class:"form-input",required:""},t[14]||(t[14]=[(0,a.Lk)("option",{value:""},"Select Condition",-1),(0,a.Lk)("option",{value:"new"},"New",-1),(0,a.Lk)("option",{value:"uk_used"},"Uk Used",-1),(0,a.Lk)("option",{value:"refurbished"},"Refurbished",-1)]),512),[[l.u1,(0,o.R1)(H).product_condition]]),(0,a.Lk)("p",P,(0,r.v_)((0,o.R1)(Y).condition_err),1)]),(0,a.Lk)("div",K,[t[16]||(t[16]=(0,a.Lk)("label",{for:"item-quantity",class:"form-label"},"Item Quantity",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",id:"item-quantity",min:"1",placeholder:"Stock Quantity","onUpdate:modelValue":t[7]||(t[7]=e=>(0,o.R1)(H).stock_quantity=e),class:"form-input",required:""},null,512),[[l.Jo,(0,o.R1)(H).stock_quantity]]),(0,a.Lk)("p",X,(0,r.v_)((0,o.R1)(Y).quantity_err),1)]),(0,a.Lk)("div",N,[t[18]||(t[18]=(0,a.Lk)("label",{for:"item-status",class:"form-label"},"Item Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"item-status","onUpdate:modelValue":t[8]||(t[8]=e=>(0,o.R1)(H).status=e),class:"form-input",required:""},t[17]||(t[17]=[(0,a.Lk)("option",{value:""},"Select Status",-1),(0,a.Lk)("option",{value:"active"},"Active",-1),(0,a.Lk)("option",{value:"inactive"},"Inactive",-1)]),512),[[l.u1,(0,o.R1)(H).status]]),(0,a.Lk)("p",z,(0,r.v_)((0,o.R1)(Y).status_err),1)]),(0,a.Lk)("div",B,[t[19]||(t[19]=(0,a.Lk)("label",{for:"item-description",class:"form-label"},"Item Description",-1)),(0,a.bo)((0,a.Lk)("textarea",{id:"item-description","onUpdate:modelValue":t[9]||(t[9]=e=>(0,o.R1)(H).description=e),class:"form-input",placeholder:"Enter item description",rows:"4",required:""},null,512),[[l.Jo,(0,o.R1)(H).description]]),(0,a.Lk)("p",T,(0,r.v_)((0,o.R1)(Y).description_err),1),(0,a.Lk)("p",{class:"err",style:{color:"gray"},ref_key:"description_counter",ref:j},(0,r.v_)((0,o.R1)(H).description.length)+"/400 characters",513)]),(0,a.Lk)("div",W,[(0,a.Lk)("button",{type:"submit",onClick:(0,l.D$)(de,["prevent"]),class:"submit-button"},"Submit")])])])],4)],4)}}},D=t(1241);const J=(0,D.A)($,[["__scopeId","data-v-07917f66"]]);var Q=J}}]);
//# sourceMappingURL=564.22123b79.js.map